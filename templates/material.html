<!DOCTYPE html>
<html>
<head>
    <title>Материалы</title>
    <style>
        body {
            font-family: Arial, sans-serif;
        }

        table {
            width: 100%;
        }

        th, td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
    </style>
</head>
<body>
<h2>Материалы</h2>

<table id="materials-table">
    <thead>
    <tr>
        <th>Название</th>
        <th>Количество</th>
        <th>Произвести</th>
    </tr>
    </thead>
    <tbody>
    <!-- Здесь будут материалы -->
    </tbody>
</table>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script>
    function refreshMaterials() {
        $.getJSON('/api/materials', function (data) {
            data.forEach(function (material) {
                // Если строка для этого материала еще не существует, создайте ее
                if ($('#material-' + material.id).length === 0) {
                    var row = '<tr id="material-' + material.id + '"><td>' + material.name + '</td><td class="count"></td><td>' +
                        '<form class="produce-form" data-id="' + material.id + '">' +
                        '<input type="number" name="count" min="1" required>' +
                        '<button type="submit">Произвести</button>' +
                        '</form></td></tr>';
                    $('#materials-table tbody').append(row);
                }
                // Обновите количество материала
                $('#material-' + material.id + ' .count').text(material.count);
            });
        });
    }

    setInterval(refreshMaterials, 1000);  // Обновляйте каждую секунду

    $(document).on('submit', '.produce-form', function (e) {
        e.preventDefault();
        var count = $(this).find('input[name="count"]').val();
        var id = $(this).data('id');
        $.post('/api/materials/' + id + '/produce', {count: count}, refreshMaterials);
    });

    setInterval(refreshMaterials, 500); // обновляем каждые 5 секунд
    refreshMaterials(); // обновляем сразу при загрузке страницы
</script>
</body>
</html>